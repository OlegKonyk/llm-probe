# Production Environment Configuration
# Optimized for AWS deployment with Bedrock

# =============================================================================
# API Key Authentication (Production)
# =============================================================================

# Use AWS Secrets Manager for production (secure, rotatable)
API_KEY_PROVIDER=secrets-manager

# AWS Secrets Manager secret name containing API keys
# The secret should be JSON format: {"keys": [{"id": "...", "key": "..."}]}
API_KEYS_SECRET_NAME=llm-test/api-keys

# Cache TTL for API keys (in milliseconds, default: 300000 = 5 minutes)
# Higher values = fewer AWS API calls, but slower rotation detection
API_KEYS_CACHE_TTL_MS=300000

# Alternative: Use env-based keys for simpler deployments
# API_KEY_PROVIDER=env
# API_KEY=production-api-key-from-secure-store

# =============================================================================
# LLM Provider Configuration (Production)
# =============================================================================

# Use AWS Bedrock for production (managed, scalable, enterprise-grade)
LLM_PROVIDER=bedrock

# =============================================================================
# AWS Bedrock Configuration
# =============================================================================

# AWS region for Bedrock service
AWS_REGION=us-east-1

# Claude 3 Sonnet model (good balance of quality and speed)
# Alternatives:
# - anthropic.claude-3-haiku-20240307-v1:0 (faster, cheaper)
# - anthropic.claude-3-opus-20240229-v1:0 (highest quality)
BEDROCK_MODEL=anthropic.claude-3-sonnet-20240229-v1:0

# =============================================================================
# Server Configuration
# =============================================================================

# Production port (usually 3000 or 8080)
PORT=3000

# Production environment
NODE_ENV=production

# =============================================================================
# CORS Configuration
# =============================================================================

# Production origins (replace with your actual domains)
# Multiple origins: comma-separated list
ALLOWED_ORIGINS=https://yourdomain.com,https://api.yourdomain.com

# =============================================================================
# Rate Limiting
# =============================================================================

# Stricter limits for production (15 min window)
RATE_LIMIT_WINDOW_MS=900000

# Lower request limit to prevent abuse (30 requests per 15 min)
RATE_LIMIT_MAX_REQUESTS=30

# =============================================================================
# AWS Credentials
# =============================================================================
#
# AWS credentials can be provided through multiple methods:
# 1. IAM roles (production - ECS Task Role, EC2 Instance Profile)
# 2. AWS SSO (local development - configured via `aws configure sso`)
# 3. Environment variables (AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY)
#
# For production: Use IAM roles attached to your ECS task or EC2 instance
# For local dev: Use AWS SSO with `aws sso login --profile <profile-name>`
#
# Optional: Set AWS_PROFILE to use a specific AWS CLI profile
# AWS_PROFILE=default
#
# =============================================================================
# Production Deployment Checklist
# =============================================================================
#
# 1. Set up AWS Secrets Manager secret with API keys
# 2. Configure IAM roles with necessary permissions:
#    - bedrock:InvokeModel (for LLM calls)
#    - secretsmanager:GetSecretValue (for API keys)
# 3. Configure VPC and security groups
# 4. Set up Application Load Balancer with HTTPS
# 5. Configure CloudWatch logging
# 6. Set up monitoring and alerts
# 7. Test with production traffic gradually
#
# =============================================================================
# Security Best Practices
# =============================================================================
#
# - Never commit real API keys to git
# - Use AWS Secrets Manager for sensitive data
# - Rotate API keys regularly
# - Enable CloudTrail for audit logging
# - Use VPC endpoints for AWS services
# - Enable AWS WAF for additional protection
# - Monitor CloudWatch metrics and set up alarms
